# AI Auto Replier

一个自动监控微信消息并通过AI回复的程序。

## 功能特点

- 自动监控微信窗口变化
- 自动复制微信消息并发送给AI
- 等待AI回复并自动发送回微信
- 支持中文和英文文本处理
- 智能处理表情和图片消息
- 防止频繁操作的冷却机制
- 支持优雅终止（鼠标移到屏幕角落或Ctrl+C）

## 使用要求

- Python 3.x
- 依赖库：
  - pyautogui
  - pygetwindow
  - pillow
  - pywin32

## 安装依赖
```bash
pip install pyautogui pygetwindow pillow pywin32
```
## 使用说明

1. 确保微信窗口和AI聊天窗口都在正确位置
2. 运行程序：
   ```bash
   python main.py
   ```
3. 程序会自动处理新的微信消息
4. 移动鼠标到屏幕角落或按Ctrl+C可停止程序

## 更新日志

### 24041211 @ ver 1.1
```bash
commit (HEAD -> master)
Author: XingYuan55 <dus0963@outlook.com>
Date:   Sun Dec 14 9:26 2024 +0800
    24041211 @ ver 1.1: 
    更新：
    1: 增加日志系统
    2: 将配置信息移至外部JSON文件
```


### 24030802 @ ver1.0-rc2
```bash
commit (HEAD -> master)
Author: XingYuan55 <dus0963@outlook.com>
Date:   Sun Dec 8 23:07 2024 +0800

    24120802 @ ver1.0-rc2: 修复了有时发生的以下两个问题，提升程序稳定性：
    1: 光标只会移动到相应位置，在尝试复制无果后，剪贴板里不是空的，而是刚刚ai给我发的消息，然后会将AI发来的信息发回去。
    2: 复制微信的中文来信后程序不将光标挪到AI输入框而是提示未检测到文字，剪贴板为空[]。经检验，程序确实选中了中文来信，但是就是没发给AI。
```

修复了以下问题：
1. 中文文本处理问题
   - 修复了连续发送中文和表情后无法正确复制中文文本的问题
   - 改进了剪贴板内容的编码处理

2. 剪贴板管理
   - 添加了剪贴板清空功能
   - 确保每次复制操作前清空剪贴板
   - 防止使用旧的剪贴板内容

3. 状态控制优化
   - 改进了消息处理状态的管理
   - 修复了状态重置的时机
   - 避免重复处理和错误的消息转发

4. 稳定性提升
   - 增加了关键操作的等待时间
   - 改进了异常处理机制
   - 提高了程序的整体稳定性

### 24030801 @ ver1.0-rc1
```bash
commit (HEAD -> master)
Author: XingYuan55 <dus0963@outlook.com> 
Date:   Sun Dec 8 21:52 2024 +0800

    24120801 @ ver1-rc: 已基本稳定实现功能
```

## 注意事项

1. 程序运行时请勿移动窗口位置
2. 确保微信和AI窗口都保持在前台可见
3. 不要手动干预自动操作过程
4. 程序会自动跳过表情和图片消息

## 已知问题

1. 需要预先设置好窗口位置，依赖窗口位置的固定坐标。这将在后续版本中变为外部json配置文件的设置项
2. 对图片和文件消息不支持处理

## 贡献

欢迎提交问题报告和改进建议。

## 许可证

MPL 2.0 License
